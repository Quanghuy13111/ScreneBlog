{% extends 'base.html' %}
{% load blog_extras %}

{% block title %}{{ profile_user.username }}'s Profile{% endblock %}

{% block content %}
<div class="card animate-on-scroll">
    <div class="card-body text-center p-lg-5">
        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="currentColor" class="bi bi-person-circle text-body-secondary mb-3" viewBox="0 0 16 16"><path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/><path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/></svg>
        <h2 class="card-title">{{ profile_user.username }}</h2>
        <p class="text-body-secondary">Joined on {{ profile_user.date_joined|date:"F Y" }}</p>
    </div>
</div>

<h3 class="mt-5 mb-4">Posts by {{ profile_user.username }}</h3>

<div class="row row-cols-1 row-cols-md-2 g-4">
    {% for post in user_posts %}
        <div class="col animate-on-scroll">
            <div class="card shadow-sm h-100">
                {% if post.is_image %}
                    <a href="{{ post.get_absolute_url }}"><img src="{{ post.attachment.url }}" alt="{{ post.title }}" class="card-img-top" style="height: 200px; object-fit: cover;"></a>
                {% endif %}
                <div class="card-body d-flex flex-column">
                    <h3 class="card-title h5"><a href="{{ post.get_absolute_url }}" class="text-body text-decoration-none">{{ post.title }}</a></h3>
                    <p class="card-text text-body-secondary small">
                        {{ post.created|date:"M d, Y" }} &middot; {{ post.content|calculate_reading_time }} min read
                    </p>
                    <p class="card-text flex-grow-1">{{ post.content|striptags|truncatewords:15 }}</p>
                    <small class="text-body-secondary">{{ post.likes }} likes</small>
                </div>
            </div>
        </div>
    {% empty %}
        <div class="alert alert-secondary">{{ profile_user.username }} has not published any posts yet.</div>
    {% endfor %}
</div>
{% endblock %}